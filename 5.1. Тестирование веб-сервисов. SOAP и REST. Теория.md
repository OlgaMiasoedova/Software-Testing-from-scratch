# 5.1. Тестирование веб-сервисов. SOAP и REST. Теория

**Вступительное слово перед стартом модуля "Тестирование API. Работа в Postman"**

Помимо тестирования frontend, о котором мы много говорили в предыдущем модуле, существует и тестирование backend, скрытого от пользователя, где осуществляется "основная магия" для работы нашего приложения. Поэтому нам нужно уметь тестировать и его.

Плюс у тестировщиков не всегда есть доступ к графическому интерфейсу и нам необходимо проверять серверную валидацию, что нельзя сделать через встроенные в браузер инструменты.

В новом модуле мы рассмотрим одну из частей этого направления тестирования: тестирование API (тестирование веб-сервисов).

Существует несколько реализаций веб-сервисов, самые популярные из них - REST и SOAP.

Мы научимся тестировать их с помощью инструмента Postman.

Разберемся с интерфейсом, основными функциями, напишем простые автотесты и освоим подходы написания тестовой документации.

_Интерфейс этого инструмента очень сильно изменился за последние несколько лет, поэтому не пугайтесь, если в старых видео он будет отличаться. Функции остались те же._

_**В самом конце модуля есть [обновленное видео](https://stepik.org/lesson/1036793/step/1?unit=1045278) с обзором обновленного интерфейса Postman. Вы можете посмотреть его сначала, однако многие вещи вам не будут понятны без контекста. Часть студентов отмечают, что им было проще изучить его, а потом уже остальную часть модуля.**_
<br>
<br>

**Дополнительная информация**

1. Что такое API? [https://aws.amazon.com/ru/what-is/api/](https://aws.amazon.com/ru/what-is/api/)
2. Одно из самых лучших видео о тестировании REST API [https://youtu.be/UdMrvh-egqk](https://youtu.be/UdMrvh-egqk)
3. Что такое JSON? [https://habr.com/ru/post/554274/](https://habr.com/ru/post/554274/)
4. Библия QA. REST/SOAP/gRPC [https://vladislaveremeev.gitbook.io/qa_bible/seti-i-okolo-nikh/rest-soap-grpc](https://vladislaveremeev.gitbook.io/qa_bible/seti-i-okolo-nikh/rest-soap-grpc)
5. Информация о тестовых площадках для отработки навыков тестирования API [https://okiseleva.blogspot.com/2017/04/users-soap-rest.html](https://okiseleva.blogspot.com/2017/04/users-soap-rest.html)
6. Туториал по XML [https://www.w3schools.com/xml/default.asp](https://www.w3schools.com/xml/default.asp)
7. Туториал по JSON [https://www.w3schools.com/js/js_json_intro.asp](https://www.w3schools.com/js/js_json_intro.asp)
<br>
<br>

## Содержание:
### [Веб-сервисы](#text1)
### [SOAP](#text2)
### [Основные правила и ошибки в синтаксисе в XML](#text3)
### [REST](#text4)
### [Вопросы к теме](#task1)
<br>
<br>
<br>
<br>

<a id='text1'></a>
## **Веб-сервисы**
<br>

**Веб-сервис** — это технология, которая позволяет различным веб-приложениям или системам обмениваться данными и взаимодействовать друг с другом. В основе таких взаимодействий лежит API - программный интерфейс, о котором мы подробнее поговорим в следующих уроках.

Веб-сервисы могут быть реализованы различными способами. В данном уроке мы познакомимся с самыми популярными: SOAP и REST.
<br>
<br>
<br>
<br>

<a id='text2'></a>
## **SOAP**
<br>

**SOAP (Simple Object Access Protocol) -** это протокол для обмена структурированными сообщениями в распределенной среде.

SOAP использует XML для передачи сообщений и может работать с различными сетевыми протоколами. Для отправки запросов используется метод POST, в отличие от REST, который может использовать все стандартные HTTP-методы.
<br>

### **XML**

**XML (eXtensible Markup Language)** — это расширяемый язык разметки, предназначенный для структурирования, хранения и передачи данных. В отличие от HTML он не используется в верстке.

**Пример XML**

```
```<?xml version="1.0" encoding="UTF-8"?>
<bookstore>
	<book category="cooking">
	       <title lang="en">Everyday Italian</title>
	       <author>Giada De Laurentiis</author>
	       <year>2005</year>
	       <price>30.00</price>
	</book>
</bookstore>
```
<br>

### **WSDL**

Для описания функциональности веб-сервиса используется файл, написанный на **WSDL (Web Services Description Language)**, основанный на XML, в котором содержится информация о получаемых и отправляемых данных, форматах сообщений, методах.

WSDL  является обязательным элементом любого SOAP-сервиса, без которого он не может существовать.

В тестировании вы будете в первую очередь работать с файлами WSDL. Об особенностях их практического использования мы поговорим на следующих уроках.

**Пример WSDL (приведен в ознакомительных целях, на данный момент нет смысла запоминать определение каждого тэга)**

```
<?xml version="1.0"?>
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
				  xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
				  xmlns:tns="http://www.example.com/wsdl"
				  targetNamespace="http://www.example.com/wsdl">`

    `<wsdl:types>
               <!-- Описание типов данных -->
     </wsdl:types>`

    `<wsdl:message name="MyRequest">
               <!-- Описание структуры запроса -->
     </wsdl:message>`

    `<wsdl:message name="MyResponse">
               <!-- Описание структуры ответа -->
     </wsdl:message>`

    `<wsdl:portType name="MyPortType">
               <wsdl:operation name="MyOperation">
                              <wsdl:input message="tns:MyRequest"/>
                              <wsdl:output message="tns:MyResponse"/>
               </wsdl:operation>
     </wsdl:portType>`

    `<wsdl:binding name="MyBinding" type="tns:MyPortType">
               <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
               <wsdl:operation name="MyOperation">
                              <soap:operation soapAction="http://www.example.com/MyAction"/>
                              <wsdl:input>
                                                 <soap:body use="literal"/>
                              </wsdl:input>
                              <wsdl:output>
                                                 <soap:body use="literal"/>
                              </wsdl:output>
               </wsdl:operation>
     </wsdl:binding>`

    `<wsdl:service name="MyService">
	    <wsdl:port name="MyPort" binding="tns:MyBinding">
	                   <soap:address location="http://www.example.com/MyService"/>
	    </wsdl:port>
	 </wsdl:service>`
```

```
`</wsdl:definitions>`
```
<br>

- **`<wsdl:definitions>`**: Корневой элемент, определяющий WSDL-документ.
- **`<wsdl:types>`**: Определяет типы данных, используемые в сообщениях.
- **`<wsdl:message>`**: Определяет структуру данных для запроса и ответа.
- **`<wsdl:portType>`**: Описывает набор операций, которые можно выполнить.
- **`<wsdl:operation>`**: Конкретная операция, доступная через веб-сервис.
- **`<wsdl:binding>`**: Определяет протокол и формат данных для операций и сообщений.
- **`<soap:binding>`**: Указывает, что привязка использует SOAP.
- **`<wsdl:service>`**: Определяет веб-сервис.
- **`<wsdl:port>`**: Определяет конечную точку для веб-сервиса.
<br>
<br>
<br>
<br>

<a id='text3'></a>
## **Основные правила и ошибки в синтаксисе в XML**
<br>

Иногда задание на поиск ошибок в XML дают на собеседовании или перед ним. Поэтому нам важно знать особенности синтаксиса этого языка.

1. **Обязательное наличие корневого элемента**:
    
    - Ошибка: `<tag1></tag1><tag2></tag2>`
    - Правильно: `<root><tag1></tag1><tag2></tag2></root>`
2. **Наличие закрывающих тегов**:
    
    - Ошибка: `<tag>This is a paragraph.<tag>`
    - Правильно: `<tag>This is a paragraph.</tag>`
3. **Чувствительность к регистру**:
    
    - Ошибка: `<Tag>example</tag>`
    - Правильно: `<tag>example</tag>`
4. **Правильное вложение**:
    
    - Ошибка: `<b><i>Text</b></i>`
    - Правильно: `<b><i>Text</i></b>`
5. **Кавычки в значениях атрибутов**:
    
    - Ошибка: `<tag attribute=value></tag>`
    - Правильно: `<tag attribute="value"></tag>`
6. **Использование специальных значений для некоторых спецсимволов:**
    
    - Ошибка: `<tag> 5 < 10 </tag>`
    - Правильно: `<tag> 5 &lt; 10 </tag>`

Подробнее о правилах можно прочитать [здесь](https://www.w3schools.com/XML/xml_syntax.asp)
<br>
<br>
<br>
<br>

<a id='text4'></a>
## **REST**
<br>

**REST (Representational State Transfer)** — это архитектурный стиль. В отличие от SOAP, который является протоколом, он не подчиняется строгим стандартам, более гибкий, простой и легковесный.

В основе REST лежат стандартные HTTP-методы (GET, POST, PUT, DELETE), а основным форматом данных для него является JSON. Также он позволяет передавать данные в виде текста, XML, HTML и другие.
<br>

### **JSON**

**JSON (JavaScript Object Notation)** — это легковесный формат обмена данными, который удобен для чтения и написания для человека, а также для анализа и генерации машинами. Его синтаксис основан на языке JavaScript, но сам JSON существует независимо и может использоваться с другими языками программирования.

**Синтаксис JSON**

**JSON (JavaScript Object Notation)** состоит из следующих элементов:

1. **Объекты**: Коллекции пар ключ/значение, заключенные в фигурные скобки `{}`. Например: `{"name": "John", "age": 30}`
    
2. **Массивы**: Упорядоченные списки значений, заключенные в квадратные скобки `[]`. Например: `["apple", "banana", "cherry"]`. Если вам нужно заключить несколько объектов в один JSON, то в таком случае тоже нужно использовать массивы Например: `[{"name": "John", "age": 30},{"name": "Liza", "age": 55}]`
    
3. **Значения**: Могут быть строками (в двойных кавычках), числами, объектами, массивами, булевыми значениями (`true` или `false`), или `null`. Например: `"Hello World"`, `123`, `true`, `null`.
    
4. **Строки**: Последовательности символов в двойных кавычках. Например: `"example string"`
    
5. **Числа**: Целые или с плавающей точкой. Например: `100`, `20.5`
<br>

**Пример JSON**

`{     "name": "John Doe",     "age": 30,     "isEmployed": true,     "address": {       "street": "123 Main St",       "city": "Anytown"     },     "phoneNumbers": ["123-456-7890", "456-789-0123"]   }`  
 <br>

- `"name"`, `"age"`, и `"isEmployed"` — это ключи, соответствующие строковому имени, числовому возрасту и булевому значению занятости.
- `"address"` — это вложенный объект с ключами `"street"` и `"city"`.
- `"phoneNumbers"` — это массив телефонных номеров.

Далее на курсе мы будем учиться тестировать REST API посредством специального инструмента - Postman.
<br>
<br>
<br>
<br>

<a id='task1'></a>
## Вопросы к теме
<br>

#### REST это
<br>

 -  [ ] Протокол
 -  [ ] Массив в JSON
 -  [ ] Язык программирования
 -  [x] Архитектурный стиль
<br>
<br>

#### Верно ли утверждение?

> **Веб-сервис** — это технология, которая позволяет различным веб-приложениям или системам обмениваться данными и взаимодействовать друг с другом.
<br>

 -  [x] Да
 -  [ ] Нет
<br>
<br>

#### Верно ли утверждение?

> **SOAP** — это архитектурный стиль. В отличие от REST, который является протоколом, он не подчиняется строгим стандартам, более гибкий, простой и легковесный.
<br>

 -  [ ] Да
 -  [x] Нет
<br>
<br>

#### XML в отличие от HTML
<br>

 -  [ ] Используется в верстке
 -  [x] Служит для хранения и передачи данных
 -  [ ] Участвует в отображении данных
 -  [ ] Используется для создания фронтенда
<br>
<br>

#### Неверно ли утверждение?

> WSDL  является обязательным элементом любого SOAP-сервиса, без которого он не может существовать.
<br>

 -  [ ] Да
 -  [x] Нет
<br>
<br>

#### Заполните пропуски в JSON-файлe
<br>

<image src="/img/5.1. pic1.png" alt="">
<br>
<br>

#### Найдите ошибки в XML
<br>

<image src="/img/5.1. pic2.png" alt="">
